<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.jn.File.export.dao.ParameterRuleDao">

	<!-- 自定义结果集,可以将sql语句查询的Resultset结果集与实体类一一对应 -->
	<resultMap type="com.jn.File.entity.ParameterRule" id="myparameterRule">
		<!-- 用于主键的映射 -->

		<!-- 其他列映射都是用result -->
		<result column="nBin" property="nBin" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nUnitType" property="nUnitType" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nLight" property="nLight" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nLightDesc" property="nLightDesc" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nIvLow" property="nIvLow" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nIvHigh" property="nIvHigh" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nWLDLow" property="nWLDLow" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nWLDHigh" property="nWLDHigh" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nIrLow" property="nIrLow" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nIrHigh" property="nIrHigh" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nVfLow" property="nVfLow" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nVfHigh" property="nVfHigh" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nWLPLow" property="nWLPLow" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nWLPHigh" property="nWLPHigh" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nST3Low" property="nST3Low" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nST3High" property="nST3High" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nCCTLow" property="nCCTLow" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nCCTHigh" property="nCCTHigh" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nVolID" property="nVolID" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nDefault" property="nDefault" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="nIntimeStamp" property="nIntimeStamp" javaType="java.lang.String"
			jdbcType="VARCHAR" />

	</resultMap>
	<!-- 针对于不定向条件的查询，关键在于SQL语句的拼接，根据当前实际的参数来拼接SQL -->
	<insert id="save">
		insert into TBLBINRULES_TMP
		values(#{nBin,jdbcType=VARCHAR},#{nUnitType,jdbcType=VARCHAR},#{nLight,jdbcType=VARCHAR},#{nLightDesc,jdbcType=VARCHAR},#{nIvLow,jdbcType=VARCHAR},
		#{nIvHigh,jdbcType=VARCHAR},#{nWLDLow,jdbcType=VARCHAR},#{nWLDHigh,jdbcType=VARCHAR},#{nIrLow,jdbcType=VARCHAR},#{nIrHigh,jdbcType=VARCHAR},
		#{nVfLow,jdbcType=VARCHAR},#{nVfHigh,jdbcType=VARCHAR},#{nWLPLow,jdbcType=VARCHAR},#{nWLPHigh,jdbcType=VARCHAR},#{nST3Low,jdbcType=VARCHAR},
		#{nST3High,jdbcType=VARCHAR},#{nVolID,jdbcType=VARCHAR},#{nDefault,jdbcType=VARCHAR},#{nIntimeStamp,jdbcType=VARCHAR},#{nCCTLow,jdbcType=VARCHAR},#{nCCTHigh,jdbcType=VARCHAR})
	</insert>
	<delete id="delAll">
		TRUNCATE TABLE TBLBINRULES_TMP
	</delete>
	<select id="verTime" resultType="java.lang.String">
		SELECT
		DISTINCT
		SUBSTRING(tp.nVolID,CHARINDEX('_',tp.nVolID)+1,255) ver
		FROM
		tblBinRules_Tmp AS tp
	</select>
	<insert id="addBin">
		<!-- set identity_insert tblBinRules on -->
		INSERT INTO
		tblBinRules
		(nBin,nUnitType,nLight,nLightDesc,nIvLow,
		nIvHigh,nWLDLow,nWLDHigh,nIrLow,nIrHigh,
		nVfLow,nVfHigh,nWLPLow,nWLPHigh,nST3Low,
		nST3High,nVolID,nDefault,nCCTHigh,nCCTLow,
		nIntimeStamp)
		SELECT
		nBin,nUnitType,nLight,nLightDesc,nIvLow,
		nIvHigh,nWLDLow,nWLDHigh,nIrLow,nIrHigh,
		nVfLow,nVfHigh,nWLPLow,nWLPHigh,nST3Low,
		nST3High,nVolID,nDefault,nCCTHigh,nCCTLow,
		nIntimeStamp FROM
		tblBinRules_Tmp
	</insert>

	<select id="paraRule" resultMap="myparameterRule">
		SELECT * from TBLBINRULES WHERE
		nVolID LIKE #{nVolID,jdbcType=VARCHAR} + '%'
	</select>
</mapper>
