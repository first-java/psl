<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jn.insert2.file.dao.InsertsDao">

	<!-- 自定义结果集,可以将sql语句查询的Resultset结果集与实体类一一对应 -->
	<resultMap type="com.jn.insert2.entity.Inserts" id="myInsert">
		<!-- 其他列映射都是用result -->
		<result column="UnitID" property="unitID" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="TBinID" property="tBinID" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="TLotID" property="tLotID" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="StorageID" property="storageID" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="ModelID" property="modelID" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="S_Flag" property="s_Flag" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="ChipVer" property="chipVer" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="Qty" property="qty" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="Confirm_UID" property="confirm_UID" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="Confirm_TIME" property="confirm_TIME" javaType="java.lang.String"
			jdbcType="VARCHAR" />
		<result column="File_Name" property="file_Name" javaType="java.lang.String"
			jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 上传 -->
	<insert id="save" parameterType="com.jn.insert2.entity.Inserts">

		INSERT INTO tblUnitConfirm (UnitID,TBinID,TLotID, StorageID,ModelID,S_Flag,
			ChipVer,Qty,Confirm_UID,Confirm_TIME,File_Name)
		SELECT tsl.UnitID,tsl.TBinID,tsl.TLotID,tsl.StorageID,tsl.ModelID,tsl.S_Flag,tsl.ChipVer,tsl.Qty
			,#{confirm_UID,jdbcType=VARCHAR},CONVERT(varchar, getdate(), 120 ),#{file_Name,jdbcType=VARCHAR}
		FROM tblShadowList AS tsl WHERE
			tsl.UnitID=#{unitID,jdbcType=VARCHAR}
		
	</insert>

	<select id="getOne" resultType="java.lang.String" resultMap="myInsert">
		SELECT
		UnitID,TBinID,TLotID,StorageID,ModelID,S_Flag,ChipVer,Qty,Confirm_UID,Confirm_TIME,File_Name
		FROM tblUnitConfirm where UnitID=#{unitID,jdbcType=VARCHAR} or
		left(TLotID,4)=#{tLotID,jdbcType=VARCHAR}
	</select>

</mapper>