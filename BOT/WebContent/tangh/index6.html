<html>
<script type="text/javascript">
	function fore() {
		var temp = "";
		var tabLen = document.getElementById("tableID");
		var jsonT = "[";
		for (var i = 0; i < tabLen.rows.length; i++) {
			for (var j = 0; j < tabLen.rows[i].cells.length; j++) {
				//temp +=tabLen.rows[i].cells[j].innerHTML;
				if (i == 0 && j == 0) {
					jsonT += "{name:\"" + tabLen.rows[i].cells[0].innerHTML + "\",gw:\"" + tabLen.rows[i].cells[1].innerHTML + tabLen.rows[i].cells[2].innerHTML + "\",ss:\"" +  "\"}"
				} else {
					jsonT += ",{name:\"" + tabLen.rows[i].cells[0].innerHTML + "\",gw:\"" + tabLen.rows[i].cells[1].innerHTML + tabLen.rows[i].cells[2].innerHTML + "\",ss:\"" + "\"}"
				}

			}
		}
		jsonT += "]";
		console.log(jsonT);
	}
	function tableToExcel() {
		//要导出的json数据
		var temp = "";
		var tabLen = document.getElementById("tableID");
		var jsonT = "[";
		for (var i = 0; i < tabLen.rows.length; i++) {
			for (var j = 0; j < tabLen.rows[i].cells.length; j++) {
				//temp +=tabLen.rows[i].cells[j].innerHTML;
				if (i == 0 && j == 0) {
					jsonT += "{name:\"" + tabLen.rows[i].cells[0].innerHTML + "\",gw:\"" + tabLen.rows[i].cells[1].innerHTML + tabLen.rows[i].cells[2].innerHTML + "\",ss:\"" + "\"}"
				} else {
					jsonT += ",{name:\"" + tabLen.rows[i].cells[0].innerHTML + "\",gw:\"" + tabLen.rows[i].cells[1].innerHTML + tabLen.rows[i].cells[2].innerHTML + "\",ss:\"" + "\"}"
				}

			}
		}
		jsonT += "]";
		const jsonData = jsonT;
		//列标题，逗号隔开，每一个逗号就是隔开一个单元格
		let str = `姓名,电话,邮箱`;
		//增加\t为了不让表格显示科学计数法或者其他格式
		for (let i = 0; i < jsonData.length; i++) {
			for (let item in jsonData[i]) {
				str += `${jsonData[i][item] + '\t'},`;
			}
			str += '\n';
		}
		//encodeURIComponent解决中文乱码
		let uri = 'data:text/csv;charset=utf-8,\ufeff' + encodeURIComponent(str);
		//通过创建a标签实现
		let link = document.createElement("a");
		link.href = uri;
		//对下载的文件命名
		link.download = "json数据表.csv";
		document.body.appendChild(link);
		link.click();
		document.body.removeChild(link);
	}
</script>
<body onload="fore()">
	<button onclick='tableToExcel()'>导出</button>
	<table style="border:1" id="tableID">
		<tr>
			<td>一一</td>
			<td>一二</td>
			<td>一三</td>

		</tr>
		<tr>
			<td>二一</td>
			<td>二二</td>
			<td>二三</td>

		</tr>
		<tr>
			<td>三一</td>
			<td>三二</td>
			<td>三三</td>

		</tr>

	</table>
</body>
</html>